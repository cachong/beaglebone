<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>BeagleBoard.org - cape_bacon</title>
  <meta name="keywords" content="Beagle Board, BeagleBoard, beagleboard.org, BeagleBone, BeagleBoard-xM, bealgeboard, open hardware, open source, Linux, computer" />
  <link href="http://feeds.feedburner.com/BeagleBoard" rel="alternate" title="Beagle Board news feed" type="application/atom+xml" />
  <link rel="icon" href="/static/beagle.ico" type="image/x-icon" />
  <link rel="shortcut icon" href="/static/beagle.ico" type="image/x-icon" />
  <link rel="publisher" href="https://plus.google.com/109587204186717390991" />
  <style type="text/css" media="screen">@import "/static/common.css";</style>
  <style type="text/css" media="screen">@import "/static/login.css";</style>
  <style type="text/css" media="screen">@import "/static/beagle.css";</style>
  <script type="text/javascript" src="/static/jquery.js"></script>
  <script type="text/javascript" src="/static/jquery.ui.core.js"></script>
  <script type="text/javascript" src="/static/jquery.ui.widget.js"></script>
  <!--
  <script type="text/javascript" src="https://apis.google.com/js/plusone.js">
   {"parsetags": "explicit"}
  </script>
  -->
  <script type="text/javascript">
  (function() {
    var po = document.createElement("script"); po.type = "text/javascript"; po.async = true;
    po.src = "https://apis.google.com/js/plusone.js?publisherid=109587204186717390991";
    var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(po, s);
  })();
  </script>
  <script language="javascript" src="/static/jquery.js"></script>  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-3429714-1']);
    _gaq.push(['_setDomainName', 'beagleboard.org']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
 
 </head>
 <body>
 <div class="top">
  <div class="top-header"><a href="/"><img src="/static/images/beagle_logo_hdr.gif" alt="Beagle Board - beagleboard.org" border="0" width="326" height="60" /></a>
  
  <div class="social">
    <span style="padding-left:8px"><a href="http://facebook.com/beagleboard" name="header_facebook_icon"><img src=  "/static/images/icon_facebook.png" width="27" height="28" alt="facebook" border="0"/></a></span>
    <span style="padding-left:8px"><a href="http://twitter.com/beagleboardorg" name="header_twitter_icon"><img src="/static/images/icon_twitter.png" width="27" height="28" border="0" alt="twitter"/></a></span>
    <span style="padding-left:8px"><a href="https://www.youtube.com/user/jadonk"><img src="/static/images/youTube-icon.png" width="27" height="28" border="0" alt="YouTube" /></a></span>
    <span style="padding-left:8px"><a href="http://plus.google.com/+beagleboard" name="header_google+_icon"><img src="/static/images/icon_google+.png" width="27" height="28" border="0" alt="google+"/></a></span>
  </div> 
</div>
   </div>
  <a name="top" id="top"></a>
  <!-- DIV that centers page - START -->
  <div id="wrapper">
  <!--start menu bar-->
  <div id='cssmenu'>
  </div>
  <!--end menu bar-->

   <!-- Content Area - START -->
    <div id="content">
     <div id="contentbuffer">
     <div id="page">
      <script src="/static/bonescript-demo.js"></script>
      <script src="/static/jquery-ui.min.js"></script>
      <h2>BoneScript</h2>
      <div id='side-menu' class="t3_sidebar">
       <ul class="left-menu">
        <strong>Navigation</strong>
        <li><a href="/Support/BoneScript/menu/">Menu contents</a></li>
       </ul>
      </div>
      <div class="t3_content_1">
       <div id='connect-status'></div>
       <div id="content_child">

<h1>Bacon Cape</h1>
<p>The Bacon Cape is an add-on board meant to give you access to some
 hardware to help build your understanding of doing basic embedded I/O on
 BeagleBone.
</p>
<h2>Board activity</h2>
<p>When you click the "run" button below, this display will dyanmically update
    to reflect the board status. The box color should reflect the color of the
    RGB LED. The top slider should reflect the status of the push button and
    turn on the blue LED. The middle slider should reflect the status of the
    slide potentiometer and adjust the brightness of the green LED. The bottom
    slider should be adjustable on the page and adjust the brightness of the red
    LED.
</p>
<p>More information about the cape can be found at <a href="http://elinux.org/Bacon_Cape">
    the eLinux.org Bacon Cape page.
</a></p>
<div style="display: table;">
 <div style="display: table-row; width=500px;">
  <div id="led1" style="display: table-cell; height:50px;"></div>
  <div style="display: table-cell; height:50px">
   <div id="slider1" style="width:400px; vertical-align:center;"></div>
   <div id="slider2" style="width:400px; vertical-align:center;"></div>
   <div id="slider3" style="width:400px; vertical-align:center;"></div>
  </div>
 </div>
</div>
<h2>Components</h2>
<p>
    These are the major components of the Bacon Cape.
</p>
<ul>
 <li><em>S1</em>: a simple push button provides a digital input
  <ul>
   <li><em>P8_19</em>: digital I/O connection to BeagleBone</li>
   <li>Configured as active-low (low when pressed) and uses and external pull-up</li>
  </ul>
 </li>
 <li><em>D1</em>: an RGB LED provides an indicator for digital output
  <ul>
   <li><em>P9_16</em>: digital I/O connection for <em><font color="blue">BLUE</font></em></li>
   <li><em>P9_14</em>: digital I/O connection for <em><font color="green">GREEN</font></em></li>
   <li><em>P9_42</em>: digital I/O connection for <em><font color="red">RED</font></em></li>
   <li>Configured as active-high (lit when high)</li>
  </ul>
 </li>
 <li><em>R10</em>: a slide potentiometer provides an analog input
  <ul>
   <li><em>P9_36</em>: analog input connection to BeagleBone</li>
  </ul>
 </li>
 <li><em>U1</em>: shift register feeding a 7 segment display
  <img src="/static/images/cape-bacon-seg7.png" align="right" />
  <ul>
   <li><em>P9_22</em>: CLOCK</li>
   <li><em>P9_17</em>: LATCH</li>
   <li><em>P9_18</em>: DATA</li>
   <li><em>P9_15</em>: CLEAR</li>
   <li><em>LED1</em>: connected to shift register output in common anode (active-low) configuration</li>
   <li><em>a</em>: last bit shifted out</li>
   <li><em>h</em>: first bit shifted out</li>
  </ul>
 <li><em>U2</em>: I2C EEPROM connected to I2C2</li>
</ul>
<!--
<h2>Currently running code example</h2>
<script>
    onbonescriptinit = function() {
        $(document).ready(function(){demoRun('code');});
    };
</script>
-->
<h2>Demo
 <button class="dynlink" onclick="demoRun('code')">run</button>
 <button class="dynlink" onclick="demoRestore('code')">restore</button>
</h2>
<pre id="code" class="use-editor" style="height:1500px;">
console.log('Starting Bacon Cape demo');

// read in BoneScript library
var b = require('bonescript');

// define used pins
var LED_RED = 'P9_42';
var LED_GREEN = 'P9_14';
var LED_BLUE = 'P9_16';
var BUTTON = 'P8_19';
var POT = 'P9_36';
var S_DATA  = 'P9_18';
var S_CLOCK = 'P9_22';
var S_LATCH = 'P9_17';
var S_CLEAR = 'P9_15';

// define other global variables
var s = b.LOW;
var digit = 0;
var segments = [ 0xC0, 0xF9, 0xA4, 0xB0, 0x99,
                 0x92, 0x82, 0xF8, 0x80, 0x90 ];

// attach jQuery elements
try {
    $('#slider1').slider();
    $('#slider2').slider();
    $('#slider3').slider();
    $('#led1').css('width', '50px');
    $('#led1').css('height', '50px');
    $('#led1').css('background-color', 'rgb(0,0,0)');
    $("#slider3").bind("slidechange", function(event, ui) {
        updateRed({value:(ui.value/100.0)});
    });
} catch(ex) {}

// configure pins as inputs/outputs
b.pinMode(S_DATA,  b.OUTPUT);
b.pinMode(S_CLOCK, b.OUTPUT);
b.pinMode(S_LATCH, b.OUTPUT);
b.pinMode(S_CLEAR, b.OUTPUT);
b.pinMode('USR0', b.OUTPUT);
b.pinMode('USR1', b.OUTPUT);
b.pinMode('USR2', b.OUTPUT);
b.pinMode('USR3', b.OUTPUT);
b.pinMode(LED_RED, b.OUTPUT);
b.pinMode(LED_GREEN, b.OUTPUT);
b.pinMode(LED_BLUE, b.OUTPUT);
b.pinMode(BUTTON, b.INPUT);

// initial states
b.digitalWrite('USR0', b.LOW);
b.digitalWrite('USR1', b.LOW);
b.digitalWrite('USR2', b.LOW);
b.digitalWrite('USR3', b.LOW);
b.analogWrite(LED_RED, 0);
b.analogWrite(LED_GREEN, 0);
b.analogWrite(LED_BLUE, 0);
b.digitalWrite(S_DATA,  b.LOW);
b.digitalWrite(S_CLOCK, b.LOW);
b.digitalWrite(S_LATCH, b.LOW);
b.digitalWrite(S_CLEAR, b.HIGH);
//b.attachInterrupt(BUTTON, true, b.CHANGE, handleButton);

// call function to read status and perform updates
update();

function update() {
    // toggle USR0 LED
    s = (s == b.LOW) ? b.HIGH : b.LOW;
    b.digitalWrite('USR0', s, do7SegUpdate);
}

function scheduleUpdate() {
    // update again in another 100ms
    setTimeout(update, 100);
}

function do7SegUpdate(x) {
    // update 7segment LED
    digit = (digit + 1) % 10;
    
    // shift out the character LED pattern
    b.shiftOut(S_DATA, S_CLOCK, b.MSBFIRST, 
        segments[digit], doLatch);
}

function doLatch() {
    // latch in the value
    b.digitalWrite(S_LATCH, b.HIGH, doLatchLow);
}

function doLatchLow() {
    b.digitalWrite(S_LATCH, b.LOW, doAnalogRead);
}

function doAnalogRead() {
    b.analogRead(POT, updateGreen);
}

function updateGreen(x) {
    if(typeof x.value == 'undefined') return;
    updateLED({green:1-x.value});
    b.digitalRead(BUTTON, updateBlue);
}

function updateBlue(x) {
    if(typeof x.value == 'undefined') return;
    updateLED({blue:1-x.value});
    scheduleUpdate();
}

function updateRed(x) {
    if(typeof x.value == 'undefined') return;
    updateLED({red:x.value});
}

function updateLED(led) {
    if(typeof led.red == 'number') {
        b.analogWrite(LED_RED, led.red);
        this.red = led.red;
    }
    if(typeof led.green == 'number') {
        b.analogWrite(LED_GREEN, led.green);
        this.green = led.green;
    }
    if(typeof led.blue == 'number') {
        b.analogWrite(LED_BLUE, led.blue);
        this.blue = led.blue;
    }
    try {
        if(typeof this.red == 'undefined') this.red = 0;
        if(typeof this.green == 'undefined') this.green = 0;
        if(typeof this.blue == 'undefined') this.blue = 0;
        var rgb = 'rgb(' + Math.round(this.red*255) + ',' + 
            Math.round(this.green*255) + ',' +
            Math.round(this.blue*255) + ')';
        $('#led1').css('background-color', rgb);
        $("#slider1").slider("option", "value", this.blue*100);
        $("#slider2").slider("option", "value", this.green*100);
    } catch(ex) {}
}</pre>
<div readonly id='console-output' style='height: 80px;'></div>
<script>
window.onbeforeunload = restore;
function restore() {
    var b = require('bonescript');
    var p = '/sys/class/leds/beaglebone:green:usr';
    b.digitalWrite('USR0', b.LOW);
    b.digitalWrite('USR1', b.LOW);
    b.digitalWrite('USR2', b.LOW);
    b.digitalWrite('USR3', b.LOW);
    b.writeTextFile(p+'0/trigger', 'heartbeat');
    b.writeTextFile(p+'1/trigger', 'mmc0');
    b.writeTextFile(p+'2/trigger', 'cpu0');
    b.writeTextFile(p+'3/trigger', 'mmc1');
    b.detachInterrupt('P8_19');
}
</script>
<h2>See also</h2>
<h3>Reference</h3>
<ul>
    <li><a href="http://elinux.org/Bacon_Cape" class="external">Bacon Cape
        page on eLinux.org
    </a></li>
</ul>
<h3>Topics</h3>
<ul>
 <li><a href="/Support/bone101/#headers">BeagleBone expansion headers</a></li>
 <li><a href="/Support/BoneScript/#analogio">Analog I/O</a></li>
</ul>
<h3>Related functions</h3>
<ul>
 <li><a href="/Support/BoneScript/#require">require</a></li>
 <li><a href="/Support/BoneScript/pinMode/">pinMode</a></li>
 <li><a href="/Support/BoneScript/analogWrite/">analogWrite</a></li>
 <li><a href="/Support/BoneScript/analogRead/">analogRead</a></li>
 <li><a href="/Support/BoneScript/digitalWrite/">digitalWrite</a></li>
 <li><a href="/Support/BoneScript/digitalRead/">digitalRead</a></li>
</ul>
</div></div>
<div style="clear:both;"></div>
</div>
<div id="list">

</div>
<br/>
<div id="createtime">Last updated by jkridner on Mon Aug 19 2013 11:54:35 GMT-0500 (CDT).</div>

</div>
   <!-- Content Area - END -->

  <!-- Footer - START -->
  
  <!--start footer-->       
<div class="footer">
<div class="social">
     <span style="padding-left:8px"><a href="http://facebook.com/beagleboard" name="header_facebook_icon"><img src=  "/static/images/icon_facebook.png" width="27" height="28" alt="facebook" border="0"/></a></span>
    <span style="padding-left:8px"><a href="http://twitter.com/beagleboardorg" name="header_twitter_icon"><img src="/static/images/icon_twitter.png" width="27" height="28" border="0" alt="twitter"/></a></span>
	    <span style="padding-left:8px"><a href="https://www.youtube.com/user/jadonk"><img src="/static/images/youTube-icon.png" width="27" height="28" border="0" alt="YouTube" /></a></span>
    <span style="padding-left:8px"><a href="http://plus.google.com/+beagleboard" name="header_google+_icon"><img src="/static/images/icon_google+.png" width="27" height="28" border="0" alt="google+"/></a></span>
  </div> 
<div id="login">
<div class="login"> <div id="prompt_form"> | </div> <a href="/register">Register</a>
</div><br /><!--registrant=-->
</div>

<div id="footer-col1">
<ul>
<li><a href="/Products">Products</a></li>
<li><a href="/Getting Started">Getting Started</a></li>
<li><a href="/support">Support</a></li>

</ul>
</div>
<div id="footer-col2">
<ul>
<li><a href="/Community">Community</a></li>
<li><a href="/project">Projects</a></li>
<li><a href="/Videos">Videos</a></li>
</ul>
</div>
<div id="footer-col3">
<ul>
<li><a href="/about">About Us</a></li>
<li><a href="/privacy">Privacy policy</a></li>
<li><a href="/terms">Terms of Use</a></li>
</ul>
</div>
<div id="cc"><a href="http://creativecommons.org/about/license/" target="_blank"><img src="http://i.creativecommons.org/l/by-sa/3.0/88x31.png" alt="Creative Commons - Conditions - Attribution and Share Alike" border="0" width="88" height="31" /></a><span style="padding-left:8px">Except where otherwise noted, content on this site is licensed under a Creative Commons Attribution-Share Alike 3.0 license </span></div>

</div>
  <!-- Footer - END -->
  </div>
  <!-- DIV that centers page - END -->
 <div id="fb-root"></div>
 </body>
</html>
